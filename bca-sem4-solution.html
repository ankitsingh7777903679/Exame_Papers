<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-G-0EFVRCHG68"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-G-0EFVRCHG68');
    </script>
    <!-- Optimized meta tags for SEO -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Download BCA Semester 4 previous year exam papers with solutions at QuestionBanker. Access IOT, Java, WD, MAD, .NET, and practical papers for VNSGU, Surat.">
    <meta name="keywords" content="BCA Semester 4 papers, previous year exam papers, VNSGU question papers, BCA study material, IOT, Java, Web Development, MAD, .NET, QuestionBanker">
    <meta name="robots" content="index, follow">
    <meta name="author" content="QuestionBanker">
    <meta name="theme-color" content="#1A3C34">
    <meta property="og:title" content="BCA Semester 4 - Previous Year Exam Papers With Solution | QuestionBanker">
    <meta property="og:description" content="Access BCA Semester 4 previous year exam papers with solutions for IOT, Java, WD, MAD, and .NET at QuestionBanker. Perfect for VNSGU students in Surat.">
    <meta property="og:image" content="https://questionbanker.in/images/bca-sem4-banner.jpg">
    <meta property="og:url" content="https://questionbanker.in/bca-sem4-solution.html">
    <meta property="og:type" content="article">
    <meta property="og:site_name" content="QuestionBanker">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="BCA Semester 4 - Previous Year Exam Papers With Solution | QuestionBanker">
    <meta name="twitter:description" content="Access BCA Semester 4 previous year exam papers with solutions for IOT, Java, WD, MAD, and .NET at QuestionBanker.">
    <meta name="twitter:image" content="https://questionbanker.in/images/bca-sem4-banner.jpg">
    <meta name="twitter:site" content="@questionbanker">
    <link rel="canonical" href="https://questionbanker.in/bca-sem4-solution.html">
    <title>BCA Semester 4 - Previous Year Exam Papers With Solution | QuestionBanker</title>
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <!-- Structured data with FAQPage schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "Where can I download BCA Semester 4 previous year papers?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "You can download BCA Semester 4 previous year exam papers with solutions at QuestionBanker, including subjects like IOT, Java, WD, MAD, and .NET for VNSGU, Surat."
          }
        },
        {
          "@type": "Question",
          "name": "What subjects are covered in BCA Semester 4 at QuestionBanker?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "QuestionBanker provides BCA Semester 4 papers for IOT, Java, Web Development (WD), Mobile Application Development (MAD), .NET, and practical exams."
          }
        }
      ]
    }
    </script>
    <!-- Deferred CSS loading -->
    <link rel="stylesheet" href="hide.css" media="print" onload="this.media='all'">
    <script src="hide.js" defer></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" media="print" onload="this.media='all'" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous" media="print" onload="this.media='all'">
    <style>
        body {
            background-color: #1A3C34;
            color: #E0E0E0;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        .media-nav {
            background-color: #07251F;
            position: sticky;
            top: 0;
            z-index: 1000;
            padding: 10px 0;
        }
        .navbar-brand img {
            transition: transform 0.3s;
        }
        .navbar-brand img:hover {
            transform: scale(1.1);
        }
        .mode-btn a {
            color: #DBF8D7;
            font-size: 1.5rem;
            margin: 0 5px;
            transition: color 0.3s;
            text-decoration: none;
        }
        .mode-btn a:hover {
            color: #4CAF50;
        }
        .mode-btn i {
            vertical-align: middle;
        }
        .back-btn {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
        }
        .back-btn a {
            color: #DBF8D7;
            text-decoration: none;
            font-weight: bold;
            transition: color 0.3s;
        }
        .back-btn a:hover {
            color: #4CAF50;
        }
        .nav-sub .btn {
            background-color: #07251F;
            color: #E0E0E0;
            margin: 0 5px;
            border: 1px solid #4CAF50;
            transition: background-color 0.3s, color 0.3s;
        }
        .nav-sub .btn:hover,
        .nav-sub .btn.active {
            background-color: #4CAF50;
            color: white;
        }
        .q-head .btn {
            background-color: #3A3A3A;
            color: #E0E0E0;
            border: 1px solid #4CAF50;
            transition: background-color 0.3s, color 0.3s;
        }
        .q-head .btn:hover {
            background-color: #4CAF50;
            color: white;
        }
        .card {
            background-color: #2F2F2F;
            border: 1px solid #4CAF50;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .card-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: #FFFFFF;
            margin-bottom: 10px;
        }
        .card-text {
            font-size: 1rem;
            color: #B0BEC5;
            white-space: pre-wrap;
        }
        .btn-primary {
            background-color: #4CAF50;
            border: none;
        }
        .btn-primary:hover {
            background-color: #45a049;
        }
        .search-bar {
            margin-bottom: 20px;
        }
        h1, h2 {
            font-size: 1.8rem;
            font-weight: bold;
            color: #FFFFFF;
            text-align: center;
            margin-bottom: 20px;
        }
        h4 {
            font-size: 1.2rem;
            font-weight: bold;
            color: #FFFFFF;
            margin-bottom: 10px;
        }
        .code-block {
            background-color: #1E1E1E;
            border: 1px solid #FF8C00;
            border-radius: 4px;
            padding: 10px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.95rem;
            white-space: pre-wrap;
            color: #FF8C00;
            position: relative;
            margin-top: 10px;
            overflow-x: auto; /* Fix for long code lines */
        }
        .code-block::before {
            content: "Example:";
            display: block;
            color: #FFFFFF;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .copy-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 3px;
            padding: 2px 6px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: background-color 0.3s;
            z-index: 1;
        }
        .copy-btn:hover {
            background-color: #45a049;
        }
        .copy-btn.copied {
            background-color: #45a049;
            opacity: 0.8;
        }
        .onemarks-section .card-body {
            padding: 15px;
        }
        .onemarks-section .question-text {
            font-size: 1.1rem;
            color: #E0E0E0;
            margin-bottom: 10px;
        }
        .onemarks-section .answer-text {
            font-size: 1rem;
            color: #B0BEC5;
            margin-bottom: 15px;
            white-space: pre-wrap;
        }
        .card .image-gallery {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        .card .image-gallery img {
            border: 1px solid #4CAF50;
            border-radius: 4px;
            max-width: 100%;
            height: auto;
            flex: 1 1 calc(25% - 10px);
            object-fit: cover;
            loading: lazy;
        }
        @media (max-width: 768px) {
            .card .image-gallery img {
                flex: 1 1 calc(50% - 10px);
            }
        }
        @media (max-width: 576px) {
            .card .image-gallery img {
                flex: 1 1 100%;
            }
        }
        #backToTopBtn {
            display: none;
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
            transition: background-color 0.3s, transform 0.3s;
        }
        #backToTopBtn:hover {
            background-color: #45a049;
            transform: scale(1.1);
        }
        .onemarks-section .answer-text {
            font-size: 1rem;
            color: #B0BEC5;
            margin-bottom: 15px;
            white-space: pre-wrap;
            list-style: none;
        }
        .onemarks-section .answer-text::before {
            content: "○";
            color: #E0E0E0;
            margin-right: 8px;
        }
        .suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background-color: #2F2F2F;
            border: 1px solid #4CAF50;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            max-height: 200px;
            overflow-y: auto;
            display: none;
        }
        .suggestion-item {
            padding: 8px 12px;
            color: #E0E0E0;
            cursor: pointer;
            border-bottom: 1px solid #4CAF50;
        }
        .suggestion-item:last-child {
            border-bottom: none;
        }
        .suggestion-item:hover {
            background-color: #3A3A3A;
        }
        .suggestion-item.loading {
            text-align: center;
            color: #B0BEC5;
        }
        .btn-clear {
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 0 4px 4px 0;
            padding: 0 10px;
            cursor: pointer;
            transition: background-color 0.3s;
            display: none;
        }
        .btn-clear:hover {
            background-color: #45a049;
        }
        .input-group {
            position: relative;
            display: flex;
        }
        .input-group .form-control {
            border-radius: 4px 0 0 4px;
            border-right: none;
        }
        .btn-years .btn {
            background-color: #07251F;
            color: #E0E0E0;
            border: 1px solid #4CAF50;
            padding: 10px 20px;
            font-size: 1rem;
            border-radius: 8px;
            transition: background-color 0.3s, color 0.3s, transform 0.3s;
            width: 100%;
            max-width: 200px;
            margin: 10px auto;
        }
        .btn-years .btn:hover,
        .btn-years .btn:focus {
            background-color: #4CAF50;
            color: white;
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(76, 175, 80, 0.3);
        }
        .btn-years .col {
            padding: 0 10px;
        }
        .btn-years {
            justify-content: center;
        }
        .comment-section {
            background-color: #2F2F2F;
            border: 1px solid #4CAF50;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        .comment-section h4 {
            margin-bottom: 15px;
        }
        .comment-form {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .comment-form textarea {
            background-color: #3A3A3A;
            color: #E0E0E0;
            border: 1px solid #4CAF50;
            border-radius: 4px;
            padding: 10px;
            flex: 1;
            resize: none;
        }
        .comment-form textarea:focus {
            outline: none;
            border-color: #4CAF50;
            box-shadow: 0 0 5px rgba(76, 175, 80, 0.3);
        }
        .comment-form button {
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 10px 20px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .comment-form button:hover {
            background-color: #45a049;
        }
        .comment-form button:disabled {
            background-color: #3A3A3A;
            cursor: not-allowed;
        }
        .comment-list {
            max-height: 300px;
            overflow-y: auto;
        }
        .comment {
            background-color: #3A3A3A;
            border-radius: 4px;
            padding: 10px;
            margin-bottom: 10px;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        .comment-header {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .comment-image {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }
        .comment-name {
            font-weight: bold;
            color: #E0E0E0;
        }
        .comment-text {
            color: #E0E0E0;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .comment-timestamp {
            color: #B0BEC5;
            font-size: 0.85rem;
        }
        .load-more-btn {
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 10px 20px;
            cursor: pointer;
            display: block;
            margin: 10px auto;
            transition: background-color 0.3s;
        }
        .load-more-btn:hover {
            background-color: #45a049;
        }
        .load-more-btn:disabled {
            background-color: #3A3A3A;
            cursor: not-allowed;
        }
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: #4CAF50;
            color: white;
            padding: 8px;
            z-index: 1000;
        }
        .skip-link:focus {
            top: 0;
        }
    </style>
</head>

<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <nav class="container-fluid media-nav px-md-5">
        <div class="d-flex align-items-center justify-content-between">
            <a class="navbar-brand fw-bolder" href="https://questionbanker.in" aria-label="QuestionBanker Home">
                <img src="logo.webp" alt="QuestionBanker Logo" height="35">
            </a>
            <button class="d-flex align-items-center me-0 mode-btn" style="border: none; background: none;">
                <a style="color: #DBF8D7;" href="https://www.instagram.com/questionbanker_77/" target="_blank" aria-label="Visit our Instagram">
                    <i class="fa-brands fa-instagram" aria-hidden="true"></i>
                </a>
                <a style="color: #DBF8D7;" href="https://t.me/questionbanker_BOT" target="_blank" aria-label="Visit our Telegram">
                    <i class="fa-brands fa-telegram" aria-hidden="true"></i>
                </a>
            </button>
        </div>
    </nav>

    <div class="container" id="main-content">
        <div class="back-btn">
            <div>
                <i class="fa-angle-left fa-solid"></i>
                <a href="index.html" aria-label="Go to Home Page">HOME</a>
            </div>
        </div>
    </div>

    <div class="container">
        <h1>BCA Semester 4 Previous Year Exam Papers with Solutions</h1>
        <p style="text-align: center; color: #FF5555; font-weight: bold;">
            If the question doesn't load, refresh the page.
        </p>
        <ul class="nav nav-pills nav-sub justify-content-center mt-3" id="pills-tab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="btn active" id="pills-iot-tab" data-bs-toggle="pill" data-bs-target="#pills-iot" type="button" role="tab" aria-controls="pills-iot" aria-selected="true">IOT</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="btn" id="pills-java-tab" data-bs-toggle="pill" data-bs-target="#pills-java" type="button" role="tab" aria-controls="pills-java" aria-selected="false">JAVA</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="btn" id="pills-wd-tab" data-bs-toggle="pill" data-bs-target="#pills-wd" type="button" role="tab" aria-controls="pills-wd" aria-selected="false">WD</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="btn" id="pills-mad-tab" data-bs-toggle="pill" data-bs-target="#pills-mad" type="button" role="tab" aria-controls="pills-mad" aria-selected="false">MAD</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="btn" id="pills-net-tab" data-bs-toggle="pill" data-bs-target="#pills-net" type="button" role="tab" aria-controls="pills-net" aria-selected="false">.NET</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="btn" id="pills-practical-tab" data-bs-toggle="pill" data-bs-target="#pills-practical" type="button" role="tab" aria-controls="pills-practical" aria-selected="false">PRACTICAL</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="btn" id="pills-papers-tab" data-bs-toggle="pill" data-bs-target="#pills-papers" type="button" role="tab" aria-controls="pills-papers" aria-selected="false">Papers</button>
            </li>
        </ul>
    </div>

    <div class="container con-qes mt-3">
        <div class="search-bar" style="position: relative;">
            <div class="input-group">
                <label for="searchInput" class="visually-hidden">Search questions</label>
                <input type="text" id="searchInput" class="form-control" placeholder="Search questions..." aria-label="Search questions" autocomplete="off">
                <button class="btn btn-clear" type="button" aria-label="Clear search">
                    <i class="fa-solid fa-xmark"></i>
                </button>
            </div>
            <div id="suggestions" class="suggestions"></div>
        </div>

        <div class="text-white tab-content" id="pills-tabContent">
            <div class="active fade show tab-pane" id="pills-iot" role="tabpanel" aria-labelledby="pills-iot-tab" tabindex="0">
                <div class="d-flex gap-1 mb-3 q-head">
                    <a href="#iot-mcq" class="btn">MCQ</a>
                    <a href="#iot-onemarks" class="btn">Short Questions</a>
                    <a href="#iot-long" class="btn">Long</a>
                    <a href="#iot-imp" class="btn" data-subject="iot">IMP</a>
                </div>
                <div id="iot-mcq">
                    <h2>MCQ</h2>
                    <div id="iot-mcq-questions"></div>
                </div>
                <div id="iot-onemarks" class="onemarks-section">
                    <h2>Short Questions</h2>
                    <div id="iot-onemarks-questions"></div>
                </div>
                <div id="iot-long">
                    <h2>Long Questions</h2>
                    <div id="iot-long-questions"></div>
                </div>
                <div id="iot-imp">
                    <h2>Important Questions</h2>
                    <div id="iot-imp-questions"></div>
                </div>
            </div>

            <div class="fade tab-pane" id="pills-java" role="tabpanel" aria-labelledby="pills-java-tab" tabindex="0">
                <div class="d-flex gap-1 mb-3 q-head">
                    <a href="#java-mcq" class="btn">MCQ</a>
                    <a href="#java-onemarks" class="btn">Short Questions</a>
                    <a href="#java-long" class="btn">Long</a>
                    <a href="#java-imp" class="btn" data-subject="java">IMP</a>
                </div>
                <div id="java-mcq">
                    <h2>MCQ</h2>
                    <div id="java-mcq-questions"></div>
                </div>
                <div id="java-onemarks" class="onemarks-section">
                    <h2>Short Questions</h2>
                    <div id="java-onemarks-questions"></div>
                </div>
                <div id="java-long">
                    <h2>Long Questions</h2>
                    <div id="java-long-questions"></div>
                </div>
                <div id="java-imp">
                    <h2>Important Questions</h2>
                    <div id="java-imp-questions"></div>
                </div>
            </div>

            <div class="fade tab-pane" id="pills-wd" role="tabpanel" aria-labelledby="pills-wd-tab" tabindex="0">
                <div class="d-flex gap-1 mb-3 q-head">
                    <a href="#wd-mcq" class="btn">MCQ</a>
                    <a href="#wd-onemarks" class="btn">Short Questions</a>
                    <a href="#wd-long" class="btn">Long</a>
                    <a href="#wd-imp" class="btn" data-subject="wd">IMP</a>
                </div>
                <div id="wd-mcq">
                    <h2>MCQ</h2>
                    <div id="wd-mcq-questions"></div>
                </div>
                <div id="wd-onemarks" class="onemarks-section">
                    <h2>Short Questions</h2>
                    <div id="wd-onemarks-questions"></div>
                </div>
                <div id="wd-long">
                    <h2>Long Questions</h2>
                    <div id="wd-long-questions"></div>
                </div>
                <div id="wd-imp">
                    <h2>Important Questions</h2>
                    <div id="wd-imp-questions"></div>
                </div>
            </div>

            <div class="fade tab-pane" id="pills-mad" role="tabpanel" aria-labelledby="pills-mad-tab" tabindex="0">
                <div class="d-flex gap-1 mb-3 q-head">
                    <a href="#mad-mcq" class="btn">MCQ</a>
                    <a href="#mad-onemarks" class="btn">Short Questions</a>
                    <a href="#mad-long" class="btn">Long</a>
                    <a href="#mad-imp" class="btn" data-subject="mad">IMP</a>
                </div>
                <div id="mad-mcq">
                    <h2>MCQ</h2>
                    <div id="mad-mcq-questions"></div>
                </div>
                <div id="mad-onemarks" class="onemarks-section">
                    <h2>Short Questions</h2>
                    <div id="mad-onemarks-questions"></div>
                </div>
                <div id="mad-long">
                    <h2>Long Questions</h2>
                    <div id="mad-long-questions"></div>
                </div>
                <div id="mad-imp">
                    <h2>Important Questions</h2>
                    <div id="mad-imp-questions"></div>
                </div>
            </div>

            <div class="fade tab-pane" id="pills-net" role="tabpanel" aria-labelledby="pills-net-tab" tabindex="0">
                <div class="d-flex gap-1 mb-3 q-head">
                    <a href="#net-mcq" class="btn">MCQ</a>
                    <a href="#net-onemarks" class="btn">Short Questions</a>
                    <a href="#net-long" class="btn">Long</a>
                    <a href="#net-imp" class="btn" data-subject="net">IMP</a>
                </div>
                <div id="net-mcq">
                    <h2>MCQ</h2>
                    <div id="net-mcq-questions"></div>
                </div>
                <div id="net-onemarks" class="onemarks-section">
                    <h2>Short Questions</h2>
                    <div id="net-onemarks-questions"></div>
                </div>
                <div id="net-long">
                    <h2>Long Questions</h2>
                    <div id="net-long-questions"></div>
                </div>
                <div id="net-imp">
                    <h2>Important Questions</h2>
                    <div id="net-imp-questions"></div>
                </div>
            </div>

            <div class="fade tab-pane" id="pills-practical" role="tabpanel" aria-labelledby="pills-practical-tab" tabindex="0">
                <div class="d-flex gap-1 mb-3 q-head">
                    <a href="#practical-mcq" class="btn">MCQ</a>
                    <a href="#practical-onemarks" class="btn">Short Questions</a>
                    <a href="#practical-long" class="btn">Long</a>
                    <a href="#practical-imp" class="btn" data-subject="practical">IMP</a>
                </div>
                <div id="practical-mcq">
                    <h2>MCQ</h2>
                    <div id="practical-mcq-questions"></div>
                </div>
                <div id="practical-onemarks" class="onemarks-section">
                    <h2>Short Questions</h2>
                    <div id="practical-onemarks-questions"></div>
                </div>
                <div id="practical-long">
                    <h2>Long Questions</h2>
                    <div id="practical-long-questions"></div>
                </div>
                <div id="practical-imp">
                    <h2>Important Questions</h2>
                    <div id="practical-imp-questions"></div>
                </div>
            </div>

            <div class="fade tab-pane" id="pills-papers" role="tabpanel" aria-labelledby="pills-papers-tab" tabindex="0">
                <h4 class="text-center fw-bolder">SEM_4 Exam Papers</h4>
                <div class="row nav-sub row-cols-1 text-center btn-years gy-2 py-5 mx-lg-5">
                    <div class="col"><a href="https://drive.google.com/drive/folders/1MnLTIcwWZldcRNlEMmzllaCOrLw_vhL2" target="_blank"><button class="btn">OCT-NOV-2023</button></a></div>
                    <div class="col"><a href="https://drive.google.com/drive/folders/10evH0-dxRKPZ_HhQTx2cEI6HsxPrOnNH" target="_blank"><button class="btn">JULY-2023</button></a></div>
                    <div class="col"><a href="https://drive.google.com/drive/folders/1v4jBDIXSB9FLhMuTccIecGsIdw_MixhW" target="_blank"><button class="btn">APRIL-2023</button></a></div>
                    <div class="col"><a href="https://drive.google.com/drive/folders/1QwsOUC1QBrgIk_5fovvSVkuNtA2uX4ff" target="_blank"><button class="btn">APRIL-2022</button></a></div>
                    <div class="col"><a href="https://drive.google.com/drive/folders/1PX24AC1N1fQh_-MNGgp1TzXzGFcgLKet" target="_blank"><button class="btn">OCT-2019</button></a></div>
                    <div class="col"><a href="https://drive.google.com/drive/folders/1hLANhg2DFj1TLJSzyUZHvo7pfdy0ZUJz" target="_blank"><button class="btn">MARCH-2019</button></a></div>
                    <div class="col"><a href="https://drive.google.com/drive/folders/18xtiWXsqUIryLfjNBgJoPtd6yLvVQ_NO" target="_blank"><button class="btn">OCT-2018</button></a></div>
                    <div class="col"><a href="https://drive.google.com/drive/folders/1og0kMOErq6VG-AepEa2srj_ARgIyqf7O" target="_blank"><button class="btn">MARCH-2018</button></a></div>
                    <div class="col"><a href="https://drive.google.com/drive/folders/1TLKmpwFFJmymrUZyjiTJFXipGiQjt0vK" target="_blank"><button class="btn">OCT-2017</button></a></div>
                    <div class="col"><a href="https://drive.google.com/drive/folders/1JYNMGKf4fTjoPReId-4eAWEPRnx1Jv7p" target="_blank"><button class="btn">MARCH-2017</button></a></div>
                    <div class="col"><a href="https://drive.google.com/drive/folders/168iIojgaC25-qJN-QOsr1NlUuPrW7H5h" target="_blank"><button class="btn">OCT-2016</button></a></div>
                    <div class="col"><a href="https://drive.google.com/drive/folders/1fJEaPCeGFPukcM4NyI1abMup-xK06Cn2" target="_blank"><button class="btn">MARCH-2016</button></a></div>
                    <div class="col"><a href="https://drive.google.com/drive/folders/1ZDFUzhywNhclCnmEJ09gsm-MNNEWKtPA" target="_blank"><button class="btn">OCT-2015</button></a></div>
                    <div class="col"><a href="https://drive.google.com/drive/folders/1IWQNyre7tZwXwFWfld0MuUgD28jOc3UF" target="_blank"><button class="btn">MARCH-2015</button></a></div>
                </div>
            </div>
        </div>

        <!-- Comment Section -->
        <div class="container comment-section">
            <h4>Comments</h4>
            <div id="auth-section">
                <button id="signInBtn" class="btn btn-primary">Sign in with Google</button>
                <p id="userInfo" style="display: none;"></p>
            </div>
            <div class="comment-form" style="display: none;" aria-hidden="true">
                <textarea id="commentInput" rows="3" placeholder="Write a comment..." maxlength="500" aria-label="Write a comment"></textarea>
                <button id="postCommentBtn" aria-label="Post comment">Post</button>
            </div>
            <div class="comment-list" id="commentList"></div>
            <button id="loadMoreCommentsBtn" class="load-more-btn" style="display: none;" aria-label="Load more comments">Load More</button>
        </div>

        <div class="container">
            <p>Explore more: <a href="https://questionbanker.in/bca_sem3">BCA Semester 3 Papers</a> | <a href="https://questionbanker.in/bca_sem5">BCA Semester 5 Papers</a></p>
        </div>
    </div>

    <button id="backToTopBtn" aria-label="Back to Top">
        <i class="fa-arrow-up fa-solid"></i>
    </button>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
    <script type="module">
        // Firebase SDK Imports
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-analytics.js";
        import { getFirestore, collection, addDoc, query, orderBy, limit, getDocs, startAfter } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-firestore.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-auth.js";

        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBHewNLmqJPFMpLpvj2amQEapBNX9vZAuU",
            authDomain: "questionbanker-79ff9.firebaseapp.com",
            projectId: "questionbanker-79ff9",
            storageBucket: "questionbanker-79ff9.firebasestorage.app",
            messagingSenderId: "534281169916",
            appId: "1:534281169916:web:44a98c2559cf984527e079",
            measurementId: "G-YTYLDW22PH"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const db = getFirestore(app);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();

        // Authentication Handling
        const signInBtn = document.getElementById("signInBtn");
        const userInfo = document.getElementById("userInfo");
        const commentForm = document.querySelector(".comment-form");
        let currentUser = null;

        signInBtn.addEventListener("click", () => {
            signInWithPopup(auth, provider)
                .then((result) => {
                    currentUser = result.user;
                    signInBtn.style.display = "none";
                    userInfo.style.display = "block";
                    userInfo.textContent = `Signed in as: ${currentUser.displayName}`;
                    commentForm.style.display = "flex";
                    commentForm.setAttribute("aria-hidden", "false");
                })
                .catch((error) => {
                    console.error("Sign-in error:", error);
                    alert(`Failed to sign in: ${error.message}`);
                });
        });

        auth.onAuthStateChanged((user) => {
            if (user) {
                currentUser = user;
                signInBtn.style.display = "none";
                userInfo.style.display = "block";
                userInfo.textContent = `Signed in as: ${user.displayName}`;
                commentForm.style.display = "flex";
                commentForm.setAttribute("aria-hidden", "false");
            } else {
                currentUser = null;
                signInBtn.style.display = "block";
                userInfo.style.display = "none";
                commentForm.style.display = "none";
                commentForm.setAttribute("aria-hidden", "true");
            }
        });

        // Helper function to escape HTML special characters
        function escapeHtmlForAttribute(str) {
            return str
                .replace(/&/g, '&amp;')
                .replace(/"/g, '&quot;')
                .replace(/'/g, '&#39;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;');
        }

        // Global variables for questions and search
        let allQuestions = [];
        let questionMap = {};
        let tokenizedCache = new Map();

        function tokenize(text) {
            return text.toLowerCase()
                .replace(/[^\w\s]/g, '')
                .split(/\s+/);
        }

        function calculateRelevance(queryTokens, questionTokens, keywordTokens) {
            let score = 0;
            queryTokens.forEach(qToken => {
                questionTokens.forEach(qt => {
                    if (qt.includes(qToken)) {
                        score += 1;
                        if (qt === qToken) score += 2;
                        if (qt.startsWith(qToken)) score += 1;
                    }
                });
                keywordTokens.forEach(kt => {
                    if (kt.includes(qToken)) {
                        score += 3;
                        if (kt === qToken) score += 5;
                        if (kt.startsWith(qToken)) score += 2;
                    }
                });
            });
            return score;
        }

        // Fetch and Render Questions
        fetch('questions.json')
            .then(response => {
                if (!response.ok) throw new Error('Failed to fetch questions');
                return response.json();
            })
            .then(data => {
                // Store fetched data globally for later use in IMP button handler
                window.subjectData = data;
                const subjects = ['iot', 'java', 'wd', 'mad', 'net', 'practical'];
                subjects.forEach(subject => {
                    const subjectData = data[subject];
                    const sections = [
                        { name: 'mcq', questions: subjectData.mcq || [] },
                        { name: 'onemarks', questions: subjectData.onemarks || [] },
                        { name: 'long', questions: subjectData.long || [] },
                        { name: 'imp', questions: subjectData.imp || [] }
                    ];
                    sections.forEach(section => {
                        section.questions.forEach((q, index) => {
                            const questionKey = `${subject}-${section.name}-${index}`;
                            const questionTokens = tokenize(q.question);
                            const keywordTokens = q.keywords ? tokenize(q.keywords.join(' ')) : [];
                            allQuestions.push({
                                question: q.question,
                                subject: subject,
                                key: questionKey,
                                type: section.name,
                                questionTokens: questionTokens,
                                keywordTokens: keywordTokens
                            });
                            tokenizedCache.set(questionKey, { questionTokens, keywordTokens });
                            questionMap[questionKey] = { subject, section: section.name, element: null, questionText: q.question };
                        });
                    });
                });

                // Initial rendering for non-IMP sections
                renderQuestions('iot-mcq-questions', data.iot.mcq, true, false, 'iot', 'mcq');
                renderQuestions('iot-onemarks-questions', data.iot.onemarks, false, true, 'iot', 'onemarks');
                renderQuestions('iot-long-questions', data.iot.long, false, false, 'iot', 'long');
                renderQuestions('iot-imp-questions', data.iot.imp || [], false, false, 'iot', 'imp');

                renderQuestions('java-mcq-questions', data.java.mcq, true, false, 'java', 'mcq');
                renderQuestions('java-onemarks-questions', data.java.onemarks, false, true, 'java', 'onemarks');
                renderQuestions('java-long-questions', data.java.long, false, false, 'java', 'long');
                renderQuestions('java-imp-questions', data.java.imp || [], false, false, 'java', 'imp');

                renderQuestions('wd-mcq-questions', data.wd.mcq, true, false, 'wd', 'mcq');
                renderQuestions('wd-onemarks-questions', data.wd.onemarks, false, true, 'wd', 'onemarks');
                renderQuestions('wd-long-questions', data.wd.long, false, false, 'wd', 'long');
                renderQuestions('wd-imp-questions', data.wd.imp || [], false, false, 'wd', 'imp');

                renderQuestions('mad-mcq-questions', data.mad.mcq, true, false, 'mad', 'mcq');
                renderQuestions('mad-onemarks-questions', data.mad.onemarks, false, true, 'mad', 'onemarks');
                renderQuestions('mad-long-questions', data.mad.long, false, false, 'mad', 'long');
                renderQuestions('mad-imp-questions', data.mad.imp || [], false, false, 'mad', 'imp');

                renderQuestions('net-mcq-questions', data.net.mcq, true, false, 'net', 'mcq');
                renderQuestions('net-onemarks-questions', data.net.onemarks, false, true, 'net', 'onemarks');
                renderQuestions('net-long-questions', data.net.long, false, false, 'net', 'long');
                renderQuestions('net-imp-questions', data.net.imp || [], false, false, 'net', 'imp');

                renderQuestions('practical-mcq-questions', data.practical.mcq, true, false, 'practical', 'mcq');
                renderQuestions('practical-onemarks-questions', data.practical.onemarks, false, true, 'practical', 'onemarks');
                renderQuestions('practical-long-questions', data.practical.long, false, false, 'practical', 'long');
                renderQuestions('practical-imp-questions', data.practical.imp || [], false, false, 'practical', 'imp');

                // Add event listeners for IMP buttons to re-render IMP questions on click
                const impButtons = document.querySelectorAll('.q-head .btn[data-subject]');
                impButtons.forEach(button => {
                    button.addEventListener('click', (e) => {
                        e.preventDefault();
                        const subject = button.getAttribute('data-subject');
                        const impContainerId = `${subject}-imp-questions`;
                        const impContainer = document.getElementById(impContainerId);
                        // Clear previous content
                        impContainer.innerHTML = '';

                        // Determine IMP questions
                        let impQuestions = [];
                        if (window.subjectData[subject].imp && window.subjectData[subject].imp.length > 0) {
                            impQuestions = window.subjectData[subject].imp;
                        } else {
                            // Fallback: filter questions marked as important from other sections (if available)
                            ['mcq', 'onemarks', 'long'].forEach(section => {
                                const questions = window.subjectData[subject][section] || [];
                                questions.forEach(q => {
                                    if (q.isImportant) impQuestions.push(q);
                                });
                            });
                        }

                        if (impQuestions.length === 0) {
                            impContainer.innerHTML = '<p>No important questions available.</p>';
                        } else {
                            renderQuestions(impContainerId, impQuestions, false, false, subject, 'imp');
                        }
                        // Scroll to the IMP section
                        document.getElementById(`${subject}-imp`).scrollIntoView({ behavior: 'smooth', block: 'start' });
                    });
                });
            })
            .catch(error => {
                console.error('Error fetching questions:', error);
                document.querySelector('.con-qes').innerHTML = '<p>Error loading questions. Please try again later.</p>';
            });

        // Render Questions Function
        function renderQuestions(containerId, questions, isMcq = false, isOneMarks = false, subject, section) {
            const container = document.getElementById(containerId);
            if (!container) {
                console.error(`Container with ID ${containerId} not found.`);
                return;
            }
            if (!questions || questions.length === 0) {
                container.innerHTML = '<p>No questions available.</p>';
                return;
            }
            questions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.classList.add('card', 'question');
                const questionId = `${subject}-${section}-${index}`;
                questionDiv.setAttribute('id', questionId);
                const questionKey = `${subject}-${section}-${index}`;
                if (questionMap[questionKey]) {
                    questionMap[questionKey].element = questionDiv;
                }

                let imagesHtml = '';
                if (q.images && Array.isArray(q.images) && q.images.length > 0) {
                    imagesHtml = `
                        <div class="image-gallery">
                            ${q.images.map(img => `
                                <img src="${img}" alt="Diagram for ${q.question}" class="img-fluid" width="200" height="200" loading="lazy">
                            `).join('')}
                        </div>
                    `;
                }

                if (isOneMarks) {
                    questionDiv.innerHTML = `
                        <div class="card-body">
                            <p class="question-text">${q.question.replace(/</g, '&lt;').replace(/>/g, '&gt;')}</p>
                            <p class="answer-text">${q.answer.replace(/</g, '&lt;').replace(/>/g, '&gt;')}</p>
                            ${imagesHtml}
                            ${q.code ? `
                                <div class="code-block" style="position: relative;">
                                    <pre>${q.code.replace(/</g, '&lt;').replace(/>/g, '&gt;')}</pre>
                                    <button class="copy-btn" data-code="${escapeHtmlForAttribute(q.code)}" aria-label="Copy code">Copy</button>
                                </div>
                            ` : q.code === undefined ? '<p>No code available for this question.</p>' : ''}
                        </div>
                    `;
                } else if (isMcq) {
                    questionDiv.innerHTML = `
                        <div class="card-body">
                            <h4 class="card-title">${q.question.replace(/</g, '&lt;').replace(/>/g, '&gt;')}</h4>
                            ${q.options.map((option, idx) => `
                                <div>
                                    <input type="radio" name="${q.id}" value="${String.fromCharCode(97 + idx)}" id="${q.id}-option-${idx}">
                                    <label for="${q.id}-option-${idx}">${option.replace(/</g, '&lt;').replace(/>/g, '&gt;')}</label>
                                </div>
                            `).join('')}
                            <button class="btn btn-primary mt-2 submit-btn" data-question-id="${q.id}" data-correct-answer="${q.correctAnswer}" aria-label="Submit answer for ${q.question}">Submit</button>
                            <p id="${q.id}-feedback" class="mt-2"></p>
                            ${q.code ? `
                                <div class="code-block" style="position: relative;">
                                    <pre>${q.code.replace(/</g, '&lt;').replace(/>/g, '&gt;')}</pre>
                                    <button class="copy-btn" data-code="${escapeHtmlForAttribute(q.code)}" aria-label="Copy code">Copy</button>
                                </div>
                            ` : q.code === undefined ? '<p>No code available for this question.</p>' : ''}
                        </div>
                    `;
                } else {
                    questionDiv.innerHTML = `
                        <div class="card-body">
                            <h4 class="card-title">${q.question.replace(/</g, '&lt;').replace(/>/g, '&gt;')}</h4>
                            <p class="card-text">${q.answer.replace(/</g, '&lt;').replace(/>/g, '&gt;')}</p>
                            ${imagesHtml}
                            ${q.code ? `
                                <div class="code-block" style="position: relative;">
                                    <pre>${q.code.replace(/</g, '&lt;').replace(/>/g, '&gt;')}</pre>
                                    <button class="copy-btn" data-code="${escapeHtmlForAttribute(q.code)}" aria-label="Copy code">Copy</button>
                                </div>
                            ` : q.code === undefined ? '<p>No code available for this question.</p>' : ''}
                        </div>
                    `;
                }
                container.appendChild(questionDiv);
            });

            if (isMcq) {
                const submitButtons = container.querySelectorAll('.submit-btn');
                submitButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        const questionId = this.getAttribute('data-question-id');
                        const correctAnswer = this.getAttribute('data-correct-answer');
                        const selected = container.querySelector(`input[name="${questionId}"]:checked`);
                        const feedback = container.querySelector(`#${questionId}-feedback`);

                        if (!selected) {
                            feedback.textContent = "Please select an option!";
                            feedback.style.color = "orange";
                            return;
                        }

                        if (selected.value === correctAnswer) {
                            feedback.textContent = "Correct!";
                            feedback.style.color = "green";
                        } else {
                            feedback.textContent = `Incorrect. The correct answer is "${correctAnswer}".`;
                            feedback.style.color = "red";
                        }
                    });
                });
            }

            const copyButtons = container.querySelectorAll('.copy-btn');
            copyButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const code = this.getAttribute('data-code');
                    if (navigator.clipboard && window.isSecureContext) {
                        navigator.clipboard.writeText(code).then(() => {
                            this.textContent = 'Copied!';
                            this.classList.add('copied');
                            setTimeout(() => {
                                this.textContent = 'Copy';
                                this.classList.remove('copied');
                            }, 2000);
                        }).catch(err => {
                            console.error('Failed to copy:', err);
                            fallbackCopyText(code, this);
                        });
                    } else {
                        fallbackCopyText(code, this);
                    }
                });
            });
        }

        function fallbackCopyText(text, button) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                button.textContent = 'Copied!';
                button.classList.add('copied');
                setTimeout(() => {
                    button.textContent = 'Copy';
                    button.classList.remove('copied');
                }, 2000);
            } catch (err) {
                console.error('Fallback copy failed:', err);
                alert('Failed to copy text.');
            }
            document.body.removeChild(textArea);
        }

        // Search Functionality
        const searchInput = document.getElementById('searchInput');
        const suggestionsDiv = document.getElementById('suggestions');
        const clearButton = document.querySelector('.btn-clear');
        let debounceTimeout;

        suggestionsDiv.insertAdjacentHTML('beforeend', '<div class="suggestion-item loading" style="display: none;">Loading...</div>');
        const loadingIndicator = suggestionsDiv.querySelector('.loading');

        function debounceSearch() {
            clearTimeout(debounceTimeout);
            debounceTimeout = setTimeout(() => {
                const query = searchInput.value.trim();
                const queryTokens = tokenize(query);
                const questions = document.querySelectorAll('.question');
                const activeTab = document.querySelector('.nav-pills .active').id.replace('pills-', '').replace('-tab', '');

                clearButton.style.display = query ? 'inline-block' : 'none';

                suggestionsDiv.innerHTML = '';
                suggestionsDiv.appendChild(loadingIndicator);
                suggestionsDiv.style.display = query ? 'block' : 'none';
                loadingIndicator.style.display = query ? 'block' : 'none';

                if (!query) {
                    questions.forEach(q => {
                        const questionSubject = q.id.split('-')[0];
                        q.style.display = (questionSubject === activeTab) ? '' : 'none';
                        const questionTextElement = q.querySelector('.question-text, .card-title, .card-text');
                        if (questionTextElement) {
                            const originalText = questionTextElement.getAttribute('data-original-text') || questionTextElement.textContent;
                            questionTextElement.innerHTML = originalText;
                            questionTextElement.setAttribute('data-original-text', originalText);
                        }
                    });
                    suggestionsDiv.style.display = 'none';
                    return;
                }

                const matchingQuestions = allQuestions
                    .map(q => {
                        if (q.subject !== activeTab) return null;
                        const { questionTokens, keywordTokens } = tokenizedCache.get(q.key);
                        const relevance = calculateRelevance(queryTokens, questionTokens, keywordTokens);
                        return relevance > 0 ? { ...q, relevance } : null;
                    })
                    .filter(q => q !== null)
                    .sort((a, b) => b.relevance - a.relevance);

                loadingIndicator.style.display = 'none';
                if (matchingQuestions.length > 0) {
                    matchingQuestions.slice(0, 10).forEach(q => {
                        const suggestionItem = document.createElement('div');
                        suggestionItem.classList.add('suggestion-item');
                        suggestionItem.textContent = q.question;
                        suggestionItem.setAttribute('data-key', q.key);
                        suggestionItem.addEventListener('click', function() {
                            searchInput.value = q.question;
                            suggestionsDiv.style.display = 'none';
                            const questionInfo = questionMap[q.key];
                            if (questionInfo && questionInfo.element) {
                                questions.forEach(qq => {
                                    const qqSubject = qq.id.split('-')[0];
                                    qq.style.display = (qqSubject === activeTab && qq === questionInfo.element) ? '' : 'none';
                                    const qqTextElement = qq.querySelector('.question-text, .card-title, .card-text');
                                    if (qqTextElement) {
                                        const originalText = qqTextElement.getAttribute('data-original-text') || qqTextElement.textContent;
                                        qqTextElement.innerHTML = originalText;
                                        qqTextElement.setAttribute('data-original-text', originalText);
                                    }
                                });
                                highlightText(questionInfo.element, q.question);
                                questionInfo.element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            }
                        });
                        suggestionsDiv.appendChild(suggestionItem);
                    });
                    suggestionsDiv.style.display = 'block';
                } else {
                    suggestionsDiv.innerHTML = '<div class="suggestion-item">No suggestions found.</div>';
                    suggestionsDiv.style.display = 'block';
                }

                let anyMatch = false;
                questions.forEach(q => {
                    const questionSubject = q.id.split('-')[0];
                    if (questionSubject !== activeTab) {
                        q.style.display = 'none';
                        return;
                    }
                    const { questionTokens, keywordTokens } = tokenizedCache.get(q.id) || { questionTokens: tokenize(q.textContent), keywordTokens: [] };
                    const matches = queryTokens.every(token =>
                        questionTokens.some(qToken => qToken.includes(token)) ||
                        keywordTokens.some(kToken => kToken.includes(token))
                    );
                    if (matches) {
                        anyMatch = true;
                        q.style.display = '';
                        highlightText(q, query);
                    } else {
                        q.style.display = 'none';
                    }
                });
            }, 300);
        }

        function highlightText(element, query) {
            const questionTextElement = element.querySelector('.question-text, .card-title, .card-text');
            if (!questionTextElement) return;
            const text = questionTextElement.textContent;
            questionTextElement.setAttribute('data-original-text', text);
            const regex = new RegExp(`(${query})`, 'gi');
            questionTextElement.innerHTML = text.replace(regex, '<span style="background-color: yellow; color: black;">$1</span>');
        }

        searchInput.addEventListener('input', debounceSearch);

        clearButton.addEventListener('click', function() {
            searchInput.value = '';
            const questions = document.querySelectorAll('.question');
            const activeTab = document.querySelector('.nav-pills .active').id.replace('pills-', '').replace('-tab', '');
            questions.forEach(q => {
                const questionSubject = q.id.split('-')[0];
                q.style.display = (questionSubject === activeTab) ? '' : 'none';
                const questionTextElement = q.querySelector('.question-text, .card-title, .card-text');
                if (questionTextElement) {
                    const originalText = questionTextElement.getAttribute('data-original-text') || questionTextElement.textContent;
                    questionTextElement.innerHTML = originalText;
                    questionTextElement.setAttribute('data-original-text', originalText);
                }
            });
            clearButton.style.display = 'none';
            suggestionsDiv.style.display = 'none';
        });

        document.addEventListener('click', function(event) {
            if (!searchInput.contains(event.target) && !suggestionsDiv.contains(event.target) && !clearButton.contains(event.target)) {
                suggestionsDiv.style.display = 'none';
            }
        });

        // Back to Top Button
        const backToTopBtn = document.getElementById('backToTopBtn');
        window.addEventListener('scroll', function() {
            backToTopBtn.style.display = window.scrollY > 300 ? 'block' : 'none';
        });
        backToTopBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Comment Functionality
        const commentInput = document.getElementById('commentInput');
        const postCommentBtn = document.getElementById('postCommentBtn');
        const commentList = document.getElementById('commentList');
        const loadMoreCommentsBtn = document.getElementById('loadMoreCommentsBtn');
        const COMMENTS_PER_PAGE = 10;
        let lastVisible = null;

        async function fetchComments(page = 0) {
            try {
                let q = query(
                    collection(db, 'comments'),
                    orderBy('timestamp', 'desc'),
                    limit(COMMENTS_PER_PAGE)
                );
                if (page > 0 && lastVisible) {
                    q = query(
                        collection(db, 'comments'),
                        orderBy('timestamp', 'desc'),
                        startAfter(lastVisible),
                        limit(COMMENTS_PER_PAGE)
                    );
                }
                const snapshot = await getDocs(q);
                const comments = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                if (page === 0) commentList.innerHTML = '';
                comments.forEach(comment => {
                    if (!document.querySelector(`[data-comment-id="${comment.id}"]`)) {
                        const commentDiv = document.createElement('div');
                        commentDiv.classList.add('comment');
                        commentDiv.setAttribute('data-comment-id', comment.id);
                        commentDiv.innerHTML = `
                            <div class="comment-header">
                                <img src="${comment.image || 'https://via.placeholder.com/50'}" alt="${comment.name}'s profile" class="comment-image">
                                <span class="comment-name">${comment.name || 'Anonymous'}</span>
                            </div>
                            <p class="comment-text">${comment.text.replace(/</g, '&lt;').replace(/>/g, '&gt;')}</p>
                            <p class="comment-timestamp">${new Date(comment.timestamp).toLocaleString()}</p>
                        `;
                        commentList.appendChild(commentDiv);
                    }
                });
                lastVisible = snapshot.docs[snapshot.docs.length - 1];
                loadMoreCommentsBtn.style.display = comments.length < COMMENTS_PER_PAGE ? 'none' : 'block';
            } catch (error) {
                console.error('Error fetching comments:', error);
                commentList.innerHTML = '<p>Error loading comments.</p>';
            }
        }

        async function postComment() {
            const commentText = commentInput.value.trim();
            if (!commentText) {
                alert('Please enter a comment.');
                return;
            }
            if (!currentUser) {
                alert('Please sign in to post a comment.');
                return;
            }
            postCommentBtn.disabled = true;
            try {
                await addDoc(collection(db, 'comments'), {
                    text: commentText,
                    name: currentUser.displayName || "Anonymous",
                    image: currentUser.photoURL || "https://via.placeholder.com/50",
                    timestamp: new Date().toISOString()
                });
                commentInput.value = '';
                fetchComments(0);
            } catch (error) {
                console.error('Error posting comment:', error);
                alert('Failed to post comment.');
            } finally {
                postCommentBtn.disabled = false;
            }
        }

        postCommentBtn.addEventListener('click', postComment);
        commentInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                postComment();
            }
        });
        loadMoreCommentsBtn.addEventListener('click', () => fetchComments(lastVisible ? 1 : 0));
        fetchComments(0);
    </script>
</body>
</html>